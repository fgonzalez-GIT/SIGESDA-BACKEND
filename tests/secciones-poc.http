### üìö Pruebas de Concepto - Sistema de Secciones/Grupos - SIGESDA
### Estas pruebas validan el dise√±o propuesto ANTES de la implementaci√≥n

@baseUrl = http://localhost:8000/api

###############################################################################
### ESCENARIO 1: Validar Limitaci√≥n Actual
### Confirmar que el sistema actual NO permite grupos paralelos
###############################################################################

### 1.1 Crear actividad Piano Nivel 1
# @name crearPiano
POST {{baseUrl}}/actividades
Content-Type: application/json

{
  "nombre": "Piano Nivel 1 - POC",
  "tipo": "CLASE_INSTRUMENTO",
  "descripcion": "Clase de piano para nivel inicial",
  "precio": 5000,
  "capacidadMaxima": 8
}

### 1.2 Intentar agregar PRIMER horario (debe funcionar)
POST {{baseUrl}}/actividades/{{crearPiano.response.body.data.id}}/horarios
Content-Type: application/json

{
  "diaSemana": "LUNES",
  "horaInicio": "18:00",
  "horaFin": "19:00"
}

### 1.3 Intentar agregar SEGUNDO horario IGUAL (debe FALLAR)
### Expected: 400 Bad Request - "Conflicto de horarios"
POST {{baseUrl}}/actividades/{{crearPiano.response.body.data.id}}/horarios
Content-Type: application/json

{
  "diaSemana": "LUNES",
  "horaInicio": "18:00",
  "horaFin": "19:00"
}

###############################################################################
### ESCENARIO 2: Workaround Actual
### Demostrar que hay que crear actividades separadas
###############################################################################

### 2.1 Crear "Piano Nivel 1 - Grupo A"
# @name grupoA
POST {{baseUrl}}/actividades
Content-Type: application/json

{
  "nombre": "Piano Nivel 1 - Grupo A",
  "tipo": "CLASE_INSTRUMENTO",
  "descripcion": "Grupo A con Prof. Mar√≠a",
  "precio": 5000,
  "capacidadMaxima": 4,
  "horarios": [
    {
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ]
}

### 2.2 Crear "Piano Nivel 1 - Grupo B"
# @name grupoB
POST {{baseUrl}}/actividades
Content-Type: application/json

{
  "nombre": "Piano Nivel 1 - Grupo B",
  "tipo": "CLASE_INSTRUMENTO",
  "descripcion": "Grupo B con Prof. Juan",
  "precio": 5000,
  "capacidadMaxima": 4,
  "horarios": [
    {
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ]
}

### 2.3 Verificar que SE PUEDEN crear (workaround funciona)
### Problema: Son 2 actividades distintas, no 2 grupos de la misma actividad
GET {{baseUrl}}/actividades?search=Piano Nivel 1

###############################################################################
### ESCENARIO 3: Dise√±o Futuro con Secciones (MOCKUP)
### Estos endpoints NO existen a√∫n - son el dise√±o propuesto
###############################################################################

### NOTA: Los siguientes requests FALLAR√ÅN porque a√∫n no est√°n implementados
### Son ejemplos de c√≥mo funcionar√° el nuevo sistema

### 3.1 FUTURO: Crear actividad base Piano
# @name actividadBase
POST {{baseUrl}}/actividades
Content-Type: application/json

{
  "nombre": "Piano Nivel 1",
  "tipo": "CLASE_INSTRUMENTO",
  "descripcion": "Clase de piano para nivel inicial",
  "precio": 5000
}

### 3.2 FUTURO: Crear Secci√≥n/Grupo A
### Endpoint propuesto: POST /api/actividades/:id/secciones
POST {{baseUrl}}/actividades/{{actividadBase.response.body.data.id}}/secciones
Content-Type: application/json

{
  "nombre": "Grupo A",
  "codigo": "PIANO-L1-A",
  "capacidadMaxima": 4,
  "docenteIds": ["maria_id_aqui"],
  "horarios": [
    {
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ],
  "aulas": [
    {
      "aulaId": "aula1_id_aqui",
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ]
}

### 3.3 FUTURO: Crear Secci√≥n/Grupo B (mismo horario, diferente docente/aula)
POST {{baseUrl}}/actividades/{{actividadBase.response.body.data.id}}/secciones
Content-Type: application/json

{
  "nombre": "Grupo B",
  "codigo": "PIANO-L1-B",
  "capacidadMaxima": 4,
  "docenteIds": ["juan_id_aqui"],
  "horarios": [
    {
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ],
  "aulas": [
    {
      "aulaId": "aula2_id_aqui",
      "diaSemana": "LUNES",
      "horaInicio": "18:00",
      "horaFin": "19:00"
    }
  ]
}

### 3.4 FUTURO: Listar todas las secciones de una actividad
GET {{baseUrl}}/actividades/{{actividadBase.response.body.data.id}}/secciones

### 3.5 FUTURO: Inscribir alumno en Grupo A espec√≠fico
POST {{baseUrl}}/secciones/{{seccionA_id}}/participantes
Content-Type: application/json

{
  "personaId": "alumno1_id",
  "fechaInicio": "2025-03-01T00:00:00Z"
}

### 3.6 FUTURO: Inscribir alumno en Grupo B espec√≠fico
POST {{baseUrl}}/secciones/{{seccionB_id}}/participantes
Content-Type: application/json

{
  "personaId": "alumno2_id",
  "fechaInicio": "2025-03-01T00:00:00Z"
}

### 3.7 FUTURO: Ver horario semanal con secciones diferenciadas
GET {{baseUrl}}/actividades/horarios/semana
### Expected Response:
### {
###   "LUNES": [
###     {
###       "actividad": "Piano Nivel 1",
###       "seccion": "Grupo A",
###       "docente": "Mar√≠a Garc√≠a",
###       "aula": "Aula 1",
###       "horario": "18:00-19:00",
###       "participantes": 3,
###       "capacidad": 4
###     },
###     {
###       "actividad": "Piano Nivel 1",
###       "seccion": "Grupo B",
###       "docente": "Juan P√©rez",
###       "aula": "Aula 2",
###       "horario": "18:00-19:00",
###       "participantes": 4,
###       "capacidad": 4
###     }
###   ]
### }

###############################################################################
### ESCENARIO 4: Validaciones Propuestas
### Validar que el nuevo sistema previene conflictos reales
###############################################################################

### 4.1 FUTURO: Debe rechazar docente en dos secciones al mismo tiempo
### Intentar asignar Mar√≠a a Grupo B (ya est√° en Grupo A)
POST {{baseUrl}}/secciones/{{seccionB_id}}/docentes
Content-Type: application/json

{
  "docenteId": "maria_id_aqui"
}
### Expected: 400 Bad Request
### "El docente Mar√≠a Garc√≠a ya tiene asignada la secci√≥n 'Grupo A'
###  el d√≠a LUNES de 18:00 a 19:00"

### 4.2 FUTURO: Debe rechazar aula en dos secciones al mismo tiempo
POST {{baseUrl}}/secciones/{{seccionB_id}}/aulas
Content-Type: application/json

{
  "aulaId": "aula1_id_aqui",
  "diaSemana": "LUNES",
  "horaInicio": "18:00",
  "horaFin": "19:00"
}
### Expected: 400 Bad Request
### "El aula 'Aula 1' ya est√° reservada para la secci√≥n 'Grupo A'
###  el d√≠a LUNES de 18:00 a 19:00"

### 4.3 FUTURO: Debe permitir mismo docente en horarios diferentes
POST {{baseUrl}}/secciones/{{seccionC_id}}/docentes
Content-Type: application/json

{
  "docenteId": "maria_id_aqui"
}
### Si Grupo C es MARTES 18:00, debe funcionar OK

###############################################################################
### ESCENARIO 5: Reportes y Estad√≠sticas
###############################################################################

### 5.1 FUTURO: Estad√≠sticas por secci√≥n
GET {{baseUrl}}/secciones/{{seccionA_id}}/estadisticas
### Expected:
### {
###   "seccion": "Grupo A",
###   "actividad": "Piano Nivel 1",
###   "participantes": {
###     "total": 3,
###     "activos": 3,
###     "socios": 2,
###     "no_socios": 1
###   },
###   "ocupacion": {
###     "porcentaje": 75,
###     "disponibles": 1
###   },
###   "docentes": ["Mar√≠a Garc√≠a"],
###   "aulas": ["Aula 1"],
###   "horarios": [...]
### }

### 5.2 FUTURO: Carga horaria del docente (con secciones)
GET {{baseUrl}}/actividades/horarios/docente/maria_id/carga
### Expected:
### {
###   "docente": "Mar√≠a Garc√≠a",
###   "totalHorasSemana": 8,
###   "secciones": [
###     {
###       "actividad": "Piano Nivel 1",
###       "seccion": "Grupo A",
###       "horas": 1,
###       "dia": "LUNES"
###     },
###     {
###       "actividad": "Piano Nivel 1",
###       "seccion": "Grupo C",
###       "horas": 1,
###       "dia": "MARTES"
###     },
###     ...
###   ]
### }

### 5.3 FUTURO: Ocupaci√≥n general de secciones
GET {{baseUrl}}/secciones/ocupacion
### Expected:
### {
###   "total_secciones": 15,
###   "ocupacion_promedio": 82,
###   "secciones_llenas": 8,
###   "secciones_disponibles": 7,
###   "detalle": [
###     {
###       "actividad": "Piano Nivel 1",
###       "seccion": "Grupo A",
###       "ocupacion": 75,
###       "participantes": 3,
###       "capacidad": 4
###     },
###     ...
###   ]
### }

###############################################################################
### ESCENARIO 6: Migraci√≥n de Datos
### Verificar que datos existentes se migran correctamente
###############################################################################

### 6.1 Contar actividades antes de migraci√≥n
GET {{baseUrl}}/actividades?limit=1000
### Anotar: total de actividades

### 6.2 POST-MIGRACI√ìN: Verificar que cada actividad tiene secci√≥n
### Despu√©s de ejecutar migraci√≥n, cada actividad deber√≠a tener
### al menos una secci√≥n llamada "Secci√≥n Principal"
GET {{baseUrl}}/actividades/{{id_cualquiera}}/secciones
### Expected: Al menos 1 secci√≥n por actividad

### 6.3 POST-MIGRACI√ìN: Verificar que horarios se preservaron
GET {{baseUrl}}/secciones/{{seccion_id}}/horarios
### Comparar con horarios originales de la actividad

###############################################################################
### NOTAS PARA EL EQUIPO
###############################################################################

# ‚úÖ VALIDACIONES ACTUALES (funcionan ahora)
# - Escenario 1: Confirmar limitaci√≥n
# - Escenario 2: Workaround actual

# ‚è≥ PENDIENTES DE IMPLEMENTACI√ìN
# - Escenarios 3-6: Requieren implementar el nuevo sistema

# üìã CHECKLIST PRE-IMPLEMENTACI√ìN
# [ ] Todos en Escenario 1 ejecutados correctamente
# [ ] Limitaci√≥n actual documentada
# [ ] Equipo de front-end notificado de cambios
# [ ] Plan de migraci√≥n revisado
# [ ] Backup de datos realizado

# üìã CHECKLIST POST-IMPLEMENTACI√ìN
# [ ] Todos en Escenario 3 funcionan correctamente
# [ ] Todas las validaciones en Escenario 4 operativas
# [ ] Reportes en Escenario 5 retornan datos correctos
# [ ] Migraci√≥n en Escenario 6 completada sin p√©rdida de datos
# [ ] Tests E2E pasando al 100%

###############################################################################
### FIN DE PRUEBAS DE CONCEPTO
###############################################################################
